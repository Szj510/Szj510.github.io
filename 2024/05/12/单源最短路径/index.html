<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths) | ius</title><meta name="author" content="Szj"><meta name="copyright" content="Szj"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="å•æºæœ€çŸ­è·¯å¾„ç®—æ³•å­¦ä¹ ç¬”è®°ï¼Œè¯¦è§£ Dijkstra ç®—æ³•å’Œ Bellman-Ford ç®—æ³•çš„åŸç†ã€è¯æ˜ä¸å®ç°ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths)">
<meta property="og:url" content="https://ius7.qzz.io/2024/05/12/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/index.html">
<meta property="og:site_name" content="ius">
<meta property="og:description" content="å•æºæœ€çŸ­è·¯å¾„ç®—æ³•å­¦ä¹ ç¬”è®°ï¼Œè¯¦è§£ Dijkstra ç®—æ³•å’Œ Bellman-Ford ç®—æ³•çš„åŸç†ã€è¯æ˜ä¸å®ç°ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ius7.qzz.io/img/banners/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.jpg">
<meta property="article:published_time" content="2024-05-12T10:49:00.000Z">
<meta property="article:modified_time" content="2025-10-30T10:16:07.650Z">
<meta property="article:author" content="Szj">
<meta property="article:tag" content="ç®—æ³•">
<meta property="article:tag" content="å›¾è®º">
<meta property="article:tag" content="æœ€çŸ­è·¯å¾„">
<meta property="article:tag" content="Dijkstra">
<meta property="article:tag" content="Bellman-Ford">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ius7.qzz.io/img/banners/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths)",
  "url": "https://ius7.qzz.io/2024/05/12/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/",
  "image": "https://ius7.qzz.io/img/banners/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.jpg",
  "datePublished": "2024-05-12T10:49:00.000Z",
  "dateModified": "2025-10-30T10:16:07.650Z",
  "author": [
    {
      "@type": "Person",
      "name": "Szj",
      "url": "https://ius7.qzz.io"
    }
  ]
}</script><link rel="shortcut icon" href="/img/vinyltocat.png"><link rel="canonical" href="https://ius7.qzz.io/2024/05/12/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.4.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths)',
  isHighlightShrink: true,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css"><link rel="stylesheet" href="/css/transpancy.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.2/assets/css/music.css" /><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg" style="background-image: url(/img/banner2.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/vinyltocat.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">44</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/banners/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">ius</span></a><a class="nav-page-title" href="/"><span class="site-name">å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths)</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">å•æºæœ€çŸ­è·¯å¾„ (Single-Source Shortest Paths)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2024-05-12T10:49:00.000Z" title="å‘è¡¨äº 2024-05-12 18:49:00">2024-05-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-10-30T10:16:07.650Z" title="æ›´æ–°äº 2025-10-30 18:16:07">2025-10-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AE%97%E6%B3%95/">ç®—æ³•</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="å•æºæœ€çŸ­è·¯å¾„-SSSP"><a href="#å•æºæœ€çŸ­è·¯å¾„-SSSP" class="headerlink" title="å•æºæœ€çŸ­è·¯å¾„(SSSP)"></a>å•æºæœ€çŸ­è·¯å¾„ (SSSP)</h1><h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><h3 id="å›¾çš„è¾“å…¥"><a href="#å›¾çš„è¾“å…¥" class="headerlink" title="å›¾çš„è¾“å…¥"></a>å›¾çš„è¾“å…¥</h3><ul>
<li>æ— æƒå›¾: bfs å¯ä»¥æ±‚è§£å…¶æœ€çŸ­è·¯å¾„ï¼Œæ— æƒå›¾å¯ä»¥è§†ä¸ºæ¯æ¡è¾¹çš„æƒé‡éƒ½æ˜¯å•ä½æƒé‡çš„å›¾ã€‚å‰é¢å·²åˆ†äº«è¿‡ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°ï¼Œä¼ é€é—¨ <a href="https://ius7.qzz.io/2024/04/21/Elementary-Graph-Algorithms/">here</a></li>
<li> æœ‰å‘å¸¦æƒå›¾ï¼šä» u åˆ° v çš„æœ€çŸ­è·¯å¾„ä¸ºä»»æ„ä¸€æ¡æ»¡è¶³ $w (p)=Î´(u, v)$ çš„è·¯å¾„ã€‚ç»™å®šå›¾ $G=(V, E)$ï¼Œæ‰¾å‡ºä»æºç‚¹ $s\in V$ åˆ°æ¯ä¸€ä¸ªé¡¶ç‚¹ $v\in V$ çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ã€‚</li>
</ul>
<h3 id="æ¾å¼›-Relaxation"><a href="#æ¾å¼›-Relaxation" class="headerlink" title="æ¾å¼›(Relaxation)"></a>æ¾å¼› (Relaxation)</h3><p>å¯¹äºæ¯ä¸ªé¡¶ç‚¹ vï¼Œéœ€è¦ç»´æŠ¤ä¸€ä¸ªé¡¶ç‚¹å±æ€§ v.d è®°å½•ä» s åˆ° v çš„æœ€çŸ­è·¯å¾„çš„æƒé‡çš„ä¸Šç•Œã€‚v.d è¢«ç§°ä¸ºä» s åˆ° v çš„æœ€çŸ­è·¯å¾„ä¼°è®¡ (shortest-path estimate)ã€‚åˆå§‹åŒ–å¦‚ä¸‹:<br><img src="https://telegraph-image-eja.pages.dev/file/b63a6ef4467d480d1b43f.png" alt="image"><br>æ¾å¼›æ“ä½œå¦‚ä¸‹:<br><img src="https://telegraph-image-eja.pages.dev/file/e75f4fa06dd16a04b677d.png" alt="image"></p>
<blockquote>
<p>å…¶å®å°±æ˜¯åœ¨ç»´æŠ¤ v.d è¿™ä¸ªå±æ€§ï¼Œæµ‹è¯•æ˜¯å¦å¯ä»¥åˆ©ç”¨ u å¯¹ä» s åˆ° v çš„æœ€çŸ­è·¯å¾„ä¼°è®¡è¿›è¡Œæ”¹å–„ ã€‚</p>
</blockquote>
<h3 id="æ— è·¯å¾„æ€§è´¨"><a href="#æ— è·¯å¾„æ€§è´¨" class="headerlink" title="æ— è·¯å¾„æ€§è´¨"></a>æ— è·¯å¾„æ€§è´¨</h3><blockquote>
<p>è‹¥ä» &nbsp;ğ‘ &nbsp; åˆ° &nbsp;ğ‘£&nbsp; ä¸å­˜åœ¨è·¯å¾„ï¼Œåˆ™ $ğ‘£.ğ‘‘=ğ›¿(ğ‘ ,ğ‘£)=âˆ$ã€‚</p>
</blockquote>
<h3 id="ä¸Šç•Œæ€§è´¨"><a href="#ä¸Šç•Œæ€§è´¨" class="headerlink" title="ä¸Šç•Œæ€§è´¨"></a>ä¸Šç•Œæ€§è´¨</h3><blockquote>
<p>å¯¹äºæ‰€æœ‰é¡¶ç‚¹ $ğ‘£âˆˆğ‘‰$ï¼Œæœ‰ $ğ‘£.ğ‘‘â‰¥ğ›¿(ğ‘ ,ğ‘£)$ï¼Œå¹¶ä¸”è¯¥ä¸å˜å¼åœ¨å¯¹ ğº çš„è¾¹è¿›è¡Œä»»æ„é¡ºåºçš„æ¾å¼›è¿‡ç¨‹ä¸­ä¿æŒæˆç«‹ã€‚è€Œä¸”ï¼Œä¸€æ—¦ ğ‘£.ğ‘‘ è¾¾åˆ°å…¶ä¸‹ç•Œ $ğ›¿(ğ‘ ,ğ‘£)$ï¼Œğ‘£.ğ‘‘ ä¸å†æ”¹å˜ã€‚</p>
</blockquote>
<p><strong>Proof</strong></p>
<ul>
<li>base caseï¼šåˆå§‹åŒ–åï¼Œå¯¹äºæ‰€æœ‰ $ğ‘£âˆˆğ‘‰âˆ’{ğ‘ }$ï¼Œæœ‰ $ğ‘£.ğ‘‘=âˆ$ï¼Œåˆ™ $ğ‘£.ğ‘‘â‰¥ğ›¿(ğ‘ ,ğ‘£)$ æ˜¾ç„¶æˆç«‹ï¼Œè€Œå¯¹äº ğ‘ ï¼Œæœ‰ $ğ‘ .ğ‘‘=0â‰¥ğ›¿(ğ‘ ,ğ‘ )$ã€‚</li>
<li>inductive hypothesisï¼šåœ¨ç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¹‹å‰ï¼Œå¯¹äºæ‰€æœ‰é¡¶ç‚¹ $x\in V$, æœ‰ $x.d \geq \delta (s, x)$ã€‚</li>
<li>inductive stepï¼šè€ƒè™‘è¾¹ (u, v) çš„æ¾å¼›æ“ä½œï¼Œå”¯ä¸€èƒ½æ”¹å˜çš„åªæœ‰ ğ‘£.ğ‘‘ï¼Œè‹¥å®ƒå‘ç”Ÿæ”¹å˜ï¼Œæœ‰<br>$v.d = u.d + w(u, v)$<br>$\geq \delta(s, u) + w(u, v)$<br>$\ge \delta(s, v)$<br>å› ä¸º $ğ‘£.ğ‘‘â‰¥ğ›¿(ğ‘ ,ğ‘£)$ ä¸”æ¾å¼›æ“ä½œä¸ä¼šå¢å¤§ ğ‘£.ğ‘‘ï¼Œæ‰€ä»¥ä¸€æ—¦ ğ‘£.ğ‘‘ è¾¾åˆ°å…¶ä¸‹ç•Œ $ğ›¿(ğ‘ ,ğ‘£)$ï¼Œğ‘£.ğ‘‘ ä¸å†æ”¹å˜ã€‚</li>
</ul>
<h3 id="æ”¶æ•›æ€§è´¨"><a href="#æ”¶æ•›æ€§è´¨" class="headerlink" title="æ”¶æ•›æ€§è´¨"></a>æ”¶æ•›æ€§è´¨</h3><blockquote>
<p>è‹¥å¯¹äºæŸäº›é¡¶ç‚¹ $ğ‘¢,ğ‘£âˆˆğ‘‰$ï¼Œ$ğ‘ â‡ğ‘¢â†’ğ‘£$ ä¸º ğº ä¸­çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œåœ¨å¯¹ (ğ‘¢, ğ‘£) è¿›è¡Œæ¾å¼›ä¹‹å‰çš„ä»»æ„æ—¶é—´æœ‰ $ğ‘¢.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¢)$ï¼Œåˆ™åœ¨å¯¹ (ğ‘¢, ğ‘£) è¿›è¡Œæ¾å¼›ä¹‹åçš„æ—¶é—´æœ‰ $ğ‘£.ğ‘‘=ğ›¿(ğ‘ ,ğ‘£)$ã€‚</p>
</blockquote>
<p>æ ¹æ®ä¸Šç•Œæ€§è´¨ï¼Œè‹¥æ¾å¼›è¾¹ (ğ‘¢, ğ‘£) å‰çš„æŸä¸ªæ—¶åˆ»å·²ç»æœ‰ $ğ‘¢.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¢)$ï¼Œåˆ™æ­¤åè¯¥ç­‰å¼ä¿æŒæˆç«‹ã€‚å½“è¾¹ (ğ‘¢, ğ‘£) è¢«æ¾å¼›åï¼Œæœ‰<br>$v.d \leq u.d + w(u, v)$<br>$= \delta(s, u) + w(u, v)$<br>$= \delta(s, v)$<br>åˆæ ¹æ®ä¸Šç•Œæ€§è´¨ï¼Œæœ‰ $ğ‘£.ğ‘‘â‰¥ğ›¿(ğ‘ ,ğ‘£)$ï¼Œæ­¤å $ğ‘£.ğ‘‘=ğ›¿(ğ‘ ,ğ‘£)$ ä¿æŒä¸å˜</p>
<h2 id="Dijkstra-ç®—æ³•"><a href="#Dijkstra-ç®—æ³•" class="headerlink" title="Dijkstra ç®—æ³•"></a>Dijkstra ç®—æ³•</h2><p>ä½ å¯ä»¥æŠŠ Dijkstra ç®—æ³•çœ‹ä½œæ˜¯å°†å¹¿åº¦ä¼˜å…ˆæœç´¢æ¨å¹¿åˆ°åŠ æƒå›¾ã€‚æ³¢ä»æºç‚¹å‘å‡ºï¼Œå½“æ³¢ç¬¬ä¸€æ¬¡åˆ°è¾¾æŸä¸ªé¡¶ç‚¹æ—¶ï¼Œè®°å½•ä»æºç‚¹åˆ°è¯¥é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼Œæ–°çš„æ³¢ä»è¯¥é¡¶ç‚¹å‘å‡ºï¼Œç›´åˆ°è®°å½•å®Œä»æºç‚¹åˆ°æ‰€æœ‰é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦ã€‚</p>
<blockquote>
<p>$DIJKSTRA(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE (G, s)$ // åˆå§‹åŒ–<br>2 $S = \not 0$ // åˆå§‹åŒ–é¡¶ç‚¹é›†åˆ Sï¼Œè¡¨ç¤ºä» &nbsp;ğ‘ &nbsp; å¯è¾¾çš„æœ€ç»ˆæœ€çŸ­è·ç¦»å·²ç»ç¡®å®šçš„é¡¶ç‚¹çš„é›†åˆã€‚<br>3 $Q = \not 0$ // åˆå§‹åŒ–ä»¥ v.d ä¸º key çš„æœ€å°ä¼˜å…ˆé˜Ÿåˆ—<br>4 for each vertex $u \in G.V$<br>5 $INSERT (Q, u)$ // å°†æ‰€æœ‰é¡¶ç‚¹å…¥é˜Ÿ<br>6 while $Q \not = \not 0$ // åªè¦é˜Ÿåˆ—éç©ºç»§ç»­æ‰§è¡Œï¼Œæ˜“çŸ¥ä¸€å…±æ‰§è¡Œ V æ¬¡ï¼Œè¿‡ç¨‹ä¸­ $Q = V - S$ ä¸å˜<br>7 $u = EXTRACT-MIN (Q)$ // ä» Q ä¸­é€‰æ‹©å…·æœ‰æœ€å°è·¯å¾„ä¼°è®¡çš„é¡¶ç‚¹ ğ‘¢<br>8 $S = S \cup {u}$ // å°† u åŠ å…¥åˆ° S<br>9 for each vertex $v \in G.Adj[u]$<br>10 RELAX (u, v, w) // æ¾å¼›æ‰€æœ‰ä» ğ‘¢ å‘å‡ºçš„è¾¹<br>11 if the call of RELAX decreased v.d<br>12 $DECREASED-KEY (Q, v, v.d)$ // æ›´æ–° Q ä¸­é¡¶ç‚¹æœ€çŸ­è·¯å¾„ä¼°è®¡</p>
</blockquote>
<p>ä¸‹é¢ç»™å‡ºè¿‡ç¨‹ç¤ºä¾‹å›¾ï¼š<br><img src="https://telegraph-image-eja.pages.dev/file/69fa37e8cf4862d7e25ba.png" alt="image"></p>
<h3 id="Theorem-Correctness-of-Dijkstraâ€™s-algorithm"><a href="#Theorem-Correctness-of-Dijkstraâ€™s-algorithm" class="headerlink" title="Theorem(Correctness of Dijkstraâ€™s algorithm)"></a>Theorem(Correctness of Dijkstraâ€™s algorithm)</h3><p>ä¸‹é¢é‡‡ç”¨å½’çº³æ³•è¯æ˜ç®—æ³•çš„æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬å°†è¦è¯æ˜åœ¨ 6-12 è¡Œçš„æ¯ä¸€æ¬¡è¿­ä»£å¼€å§‹æ—¶ï¼Œå¯¹äºæ‰€æœ‰é¡¶ç‚¹ $ğ‘£\inğ‘†$ï¼Œæœ‰ $ğ‘£.ğ‘‘=\delta (ğ‘ ,ğ‘£)$ã€‚ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œç”±äº ğ‘† = ğ‘‰ï¼Œå› æ­¤å¯¹äºæ‰€æœ‰é¡¶ç‚¹ $ğ‘£\in ğ‘‰$ï¼Œæœ‰ $ğ‘£.ğ‘‘=\delta (ğ‘ ,ğ‘£)$ã€‚<br><strong>Proof</strong></p>
<ul>
<li>base cases<ul>
<li> å½“ $|ğ‘†|=0$ æ—¶ï¼Œæœ‰ $ğ‘† = âˆ…$ï¼Œæ–­è¨€ä¸ºçœŸã€‚</li>
<li>å½“ $|ğ‘†|=1$ æ—¶ï¼Œæœ‰ $ğ‘†={ğ‘ }$ ä¸” $ğ‘ .ğ‘‘=ğ›¿(ğ‘ ,ğ‘ )=0$ã€‚</li>
</ul>
</li>
<li>inductive hypothesisï¼šå¯¹äºæ‰€æœ‰é¡¶ç‚¹ $ğ‘£\in ğ‘‰$ï¼Œæœ‰ $ğ‘£.ğ‘‘=ğ›¿(ğ‘ ,ğ‘£)$ã€‚<br><img src="https://telegraph-image-eja.pages.dev/file/c7f1800d8c978418f3bde.png" alt="image"></li>
<li>ç®—æ³•æ¯æ¬¡è¿­ä»£æ·»åŠ ä¸€ä¸ªé¡¶ç‚¹ ğ‘¢ åˆ° ğ‘† ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¯æ˜æ“ä½œç»“æŸåæœ‰ $ğ‘¢.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¢)$ã€‚ - è‹¥ä» ğ‘  åˆ° ğ‘¢ ä¸å­˜åœ¨è·¯å¾„ï¼Œåˆ™æ ¹æ®æ— è·¯å¾„æ€§è´¨ï¼Œè¯æ˜å®Œæ¯•ã€‚ - è‹¥ä» ğ‘  åˆ° ğ‘¢ å­˜åœ¨è·¯å¾„ï¼Œå¦‚å›¾æ‰€ç¤ºï¼Œè®¾ ğ‘¦ ä¸ºä» ğ‘  åˆ° ğ‘¢ çš„è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªä¸åœ¨ ğ‘† ä¸­çš„é¡¶ç‚¹ï¼Œä»¤ $ğ‘¥âˆˆğ‘†$ ä¸º ğ‘¦ åœ¨è¯¥è·¯å¾„ä¸Šçš„å‰é©±ï¼Œå½“ç„¶å¯ä»¥å­˜åœ¨ $ğ‘¦=ğ‘¢$ æˆ–è€… $ğ‘¥=ğ‘ $ çš„æƒ…å†µï¼Œç”±äºåœ¨è¯¥è·¯å¾„ä¸Š ğ‘¦ ä¸ä¼šæ™šäº ğ‘¢ å‡ºç°ä¸”æ‰€æœ‰è¾¹çš„æƒé‡éè´Ÿï¼Œæœ‰ $ğ›¿(ğ‘ ,ğ‘¦)â‰¤ğ›¿(ğ‘ ,ğ‘¢)$ï¼Œåˆç”±äº EXTRACT-MIN è¿”å›äº† ğ‘‰âˆ’ğ‘† ä¸­ ğ‘‘ å€¼æœ€å°çš„é¡¶ç‚¹ï¼Œæœ‰ $ğ‘¢.ğ‘‘â‰¤ğ‘¦.ğ‘‘$ï¼Œæ ¹æ®ä¸Šç•Œæ€§è´¨ï¼Œæœ‰ $ğ›¿(ğ‘ ,ğ‘¢)â‰¤ğ‘¢.ğ‘‘$ã€‚ - å¯¹äº $ğ‘¥âˆˆğ‘†$ï¼Œæ ¹æ®å½’çº³å‡è®¾æœ‰ $ğ‘¥.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¥)$ã€‚åœ¨ while å¾ªç¯çš„æŸä¸€æ¬¡è¿­ä»£ä¸­ï¼Œğ‘¥ è¢«åŠ å…¥ ğ‘†ï¼Œè¾¹ (ğ‘¥, ğ‘¦) è¢«æ¾å¼›ï¼Œæ ¹æ®æ”¶æ•›æ€§è´¨ï¼Œğ‘¦.ğ‘‘ æ­¤æ—¶å¾—åˆ°æœ€å°å€¼ $ğ›¿(ğ‘ ,ğ‘¦)$ï¼Œæœ‰ $ğ›¿(ğ‘ ,ğ‘¦)â‰¤ğ›¿(ğ‘ ,ğ‘¢)â‰¤ğ‘¢.ğ‘‘â‰¤ğ‘¦.ğ‘‘$ ä¸” $ğ‘¦.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¦)$ï¼Œå³ $ğ›¿(ğ‘ ,ğ‘¦)=ğ›¿(ğ‘ ,ğ‘¢)=ğ‘¢.ğ‘‘=ğ‘¦.ğ‘‘$ã€‚å› æ­¤ $ğ‘¢.ğ‘‘=ğ›¿(ğ‘ ,ğ‘¢)$ï¼Œæ ¹æ®ä¸Šç•Œæ€§è´¨ï¼Œğ‘¢.ğ‘‘ ä¸å†æ”¹å˜ï¼Œå¾—è¯ã€‚<blockquote>
<p>ä¹Ÿå¯ä»¥ä»å¾ªç¯ä¸å˜é‡è§’åº¦ç†è§£ï¼Œåœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­ï¼Œä»¥ä¸‹æ¡ä»¶ä¿æŒä¸å˜ï¼š</p>
</blockquote>
</li>
<li>å¯¹äºæ‰€æœ‰å·²ç¡®å®šçš„é¡¶ç‚¹ vï¼Œå³åŠ å…¥åˆ° S ä¸­çš„é¡¶ç‚¹ vï¼Œå®ƒä»¬çš„ v.d æ˜¯æ­£ç¡®çš„ï¼Œå³ä»æºç‚¹åˆ°è¿™äº›é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦å·²ç»è¢«æ‰¾åˆ°ã€‚</li>
<li>å¯¹äºæ‰€æœ‰æœªç¡®å®šçš„é¡¶ç‚¹ï¼Œå­˜åœ¨ä¸€ä¸ª â€œæ¾å¼›â€ æ“ä½œï¼Œè¯¥æ“ä½œå¯ä»¥å‡å°‘æŸä¸ªé¡¶ç‚¹çš„è·ç¦»å€¼ï¼ŒåŒæ—¶ä¿æŒå…¶ä»–é¡¶ç‚¹çš„è·ç¦»å€¼ä¸å˜æˆ–å‡å°‘ã€‚<br><strong>Proof</strong></li>
<li> åˆå§‹åŒ–ï¼šåœ¨ç®—æ³•å¼€å§‹æ—¶ï¼Œåªæœ‰æºç‚¹çš„è·ç¦»å€¼è¢«è®¾ç½®ä¸º 0ï¼Œå…¶ä»–æ‰€æœ‰é¡¶ç‚¹çš„è·ç¦»å€¼è¢«è®¾ç½®ä¸ºæ— ç©·å¤§ã€‚è¿™æ»¡è¶³äº†å¾ªç¯ä¸å˜é‡çš„æ¡ä»¶ï¼Œå› ä¸ºæºç‚¹åˆ°è‡ªå·±çš„æœ€çŸ­è·¯å¾„é•¿åº¦æ˜¯ 0ï¼Œè€Œå…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦å°šæœªç¡®å®šã€‚</li>
<li>ä¿æŒï¼šåœ¨ç®—æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªæœªç¡®å®šçš„æœ€çŸ­è·ç¦»é¡¶ç‚¹ (å³é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹)ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºå·²ç¡®å®š (å³å°†å…¶åŠ å…¥åˆ° S)ã€‚ç„¶åï¼Œæˆ‘ä»¬æ›´æ–°è¿™ä¸ªé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹çš„è·ç¦»å€¼ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå·²ç¡®å®šé¡¶ç‚¹çš„è·ç¦»å€¼ä¸ä¼šæ”¹å˜ (å› ä¸ºå®ƒä»¬å·²ç»å‡ºé˜Ÿ)ï¼Œè€Œæœªç¡®å®šé¡¶ç‚¹çš„è·ç¦»å€¼åªä¼šåœ¨æ‰¾åˆ°æ›´çŸ­çš„è·¯å¾„æ—¶å‡å°‘ã€‚å› æ­¤ï¼Œå¾ªç¯ä¸å˜é‡åœ¨æ¯ä¸ªè¿­ä»£ä¸­éƒ½è¢«ä¿æŒã€‚</li>
<li>ç»ˆæ­¢ï¼šå½“ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œæ‰€æœ‰é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦éƒ½å·²ç»è¢«ç¡®å®šã€‚è¿™æ˜¯å› ä¸ºç®—æ³•åœ¨æ¯æ¬¡è¿­ä»£ä¸­éƒ½é€‰æ‹©äº†ä¸€ä¸ªæœªç¡®å®šçš„æœ€çŸ­è·ç¦»é¡¶ç‚¹ï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºå·²ç¡®å®šï¼Œç›´åˆ°æ²¡æœ‰æœªç¡®å®šçš„é¡¶ç‚¹ä¸ºæ­¢ã€‚æ ¹æ®å¾ªç¯ä¸å˜é‡ï¼Œæ‰€æœ‰å·²ç¡®å®šçš„é¡¶ç‚¹çš„è·ç¦»å€¼æ˜¯æ­£ç¡®çš„ï¼Œå› æ­¤ç®—æ³•æ‰¾åˆ°äº†ä»æºç‚¹åˆ°æ‰€æœ‰å…¶ä»–é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚<blockquote>
<p>Dijkstra çš„å±€é™æ€§åœ¨äºå®ƒè¦æ±‚æ‰€æœ‰è¾¹çš„æƒé‡éƒ½å¾— â‰¥0ï¼Œå› ä¸ºå¦‚æœå­˜åœ¨è´Ÿè¾¹ï¼ŒåŸæœ¬å·²ç»è¢«åŠ å…¥åˆ° S çš„é¡¶ç‚¹è¿˜æœ‰å¯èƒ½é€šè¿‡æœ‰è´Ÿè¾¹çš„è·¯å¾„è€Œå‡å° d å€¼ï¼Œè¿™è¿åäº†å¾ªç¯ä¸å˜é‡ã€‚</p>
</blockquote>
</li>
</ul>
<h3 id="æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>æ—¶é—´å¤æ‚åº¦åˆ†æ</h3><blockquote>
<p>$DIJKSTRA(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE(G, s)$ //O(V)<br>2 $S = \not 0$ //O(1)<br>3 $Q = \not 0$ //O(1)<br>4 for each vertex $u \in G.V$ //O(V)<br>5 $INSERT(Q, u)$ //O(1)<br>6 while $Q \not = \not 0$ //O(V)<br>7 $u = EXTRACT-MIN(Q)$ //O(V) or $ğ‘‚(lgâ¡ğ‘‰)$<br>8 $S = S \cup {u}$ //O(1)<br>9 for each vertex $v \in G.Adj [u]$ //O (E)(å› ä¸ºæ¯æ¡è¾¹éƒ½ä¼šè¢«æ¾å¼›ä¸€æ¬¡)<br>10 RELAX(u, v, w) //O(1)<br>11 if the call of RELAX decreased v.d //O(1)<br>12 $DECREASED-KEY(Q, v, v.d)$ //O(1) or $ğ‘‚(lgâ¡ğ‘‰)$</p>
</blockquote>
<p>Dijkstra ç®—æ³•çš„è¿è¡Œæ—¶é—´å–å†³äºæœ€å°ä¼˜å…ˆé˜Ÿåˆ—çš„å…·ä½“å®ç°ï¼Œä¸€ä¸ªç®€å•çš„å®ç°æ–¹å¼å°±æ˜¯å°†é¡¶ç‚¹ä» 1 åˆ° ğ‘‰ ç¼–å·ï¼Œæ„é€ ä¸€ä¸ªæ•°ç»„ &nbsp;ğ´[1 : ğ‘‰]&nbsp;ï¼Œç¼–å· ğ‘– çš„é¡¶ç‚¹ ğ‘£ çš„ ğ‘£.ğ‘‘ å­˜å‚¨åœ¨æ•°ç»„çš„ç¬¬ ğ‘– é¡¹ä¸­ï¼Œæ¯æ¬¡è°ƒç”¨ INSERT å’Œ DECREASED-KEY çš„è¿è¡Œæ—¶é—´ä¸º ğ‘‚(1)ï¼Œæ¯æ¬¡è°ƒç”¨ EXTRACT_MIN çš„è¿è¡Œæ—¶é—´ä¸º ğ‘‚(ğ‘‰)&nbsp;(ç”±äºéœ€è¦éå†æ•´ä¸ªæ•°ç»„æ‰¾åˆ°æœ€å°å€¼)ï¼Œæ€»çš„è¿è¡Œæ—¶é—´ä¸º $ğ‘‚(ğ‘‰^2+ğ¸)=ğ‘‚(ğ‘‰^2)$ã€‚</p>
<p>å¦‚æœå›¾è¶³å¤Ÿç¨€ç–ï¼Œç‰¹åˆ«çš„ï¼Œå¦‚æœ $ğ¸=ğ‘œ(ğ‘‰^2/lgâ¡ğ‘‰)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ€å°äºŒå‰å †å®ç°æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œå…¶ä¸­åŒ…å«å°†é¡¶ç‚¹æ˜ å°„åˆ°å¯¹åº”çš„å †ä¸­å…ƒç´ çš„å‡½æ•°ï¼Œæ¯æ¬¡è°ƒç”¨ EXTRACT_MIN çš„è¿è¡Œæ—¶é—´ä¸º $ğ‘‚(lgâ¡ğ‘‰)$ï¼Œæ„å»ºæœ€å°äºŒå‰å †çš„è¿è¡Œæ—¶é—´ä¸º ğ‘‚(ğ‘‰)ï¼Œæ€»çš„è¿è¡Œæ—¶é—´ä¸º $ğ‘‚((ğ‘‰+ğ¸) lgâ¡ğ‘‰)$ï¼Œè‹¥ $E=\Omega (V)$ï¼Œåˆ™æ€»çš„è¿è¡Œæ—¶é—´ä¸º $ğ‘‚(ğ¸lgâ¡ğ‘‰)$ã€‚è‹¥ $ğ¸=ğ‘œ(ğ‘‰^2/lgâ¡ğ‘‰)$ï¼Œåˆ™æ€»çš„è¿è¡Œæ—¶é—´ç›¸æ¯” $ğ‘‚(ğ‘‰^2)$ æœ‰æ‰€æ”¹å–„ã€‚</p>
<h3 id="ç©ºé—´å¤æ‚åº¦åˆ†æ"><a href="#ç©ºé—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="ç©ºé—´å¤æ‚åº¦åˆ†æ"></a>ç©ºé—´å¤æ‚åº¦åˆ†æ</h3><blockquote>
<p>$DIJKSTRA(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE(G, s)$ //O(V)<br>2 $S = \not 0$ //O(V)<br>3 $Q = \not 0$ //O(V)<br>4 for each vertex $u \in G.V$<br>5 $INSERT(Q, u)$ //O(1)<br>6 while $Q \not = \not 0$<br>7 $u = EXTRACT-MIN(Q)$ //O(1)<br>8 $S = S \cup {u}$ //O(1)<br>9 for each vertex $v \in G.Adj[u]$<br>10 RELAX(u, v, w)<br>11 if the call of RELAX decreased v.d<br>12 $DECREASED-KEY(Q, v, v.d)$ //O(1)</p>
</blockquote>
<p>æ‰€ä»¥æ€»ç©ºé—´å¤æ‚åº¦ä¸º $O (V)$</p>
<h3 id="cpp-ç®—æ³•å®ç°"><a href="#cpp-ç®—æ³•å®ç°" class="headerlink" title="cpp ç®—æ³•å®ç°"></a>cpp ç®—æ³•å®ç°</h3><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;limits&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// é¡¶ç‚¹ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Vertex</span> {</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> index; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="comment">// é¡¶ç‚¹ç´¢å¼•</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> distance; &nbsp; &nbsp; &nbsp; <span class="comment">// åˆ°æºé¡¶ç‚¹çš„è·ç¦»</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> parent; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// å‰é©±èŠ‚ç‚¹ç´¢å¼•</span></span><br><span class="line">&nbsp; &nbsp; <span class="built_in">Vertex</span>(<span class="type">int</span> i, <span class="type">int</span> d, <span class="type">int</span> p) : <span class="built_in">index</span>(i), <span class="built_in">distance</span>(d), <span class="built_in">parent</span>(p) {}</span><br><span class="line">&nbsp; &nbsp; <span class="comment">// è‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°ï¼Œç”¨äºä¼˜å…ˆé˜Ÿåˆ—</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">bool</span> <span class="keyword">operator</span>&gt;(<span class="type">const</span> Vertex&amp; other) <span class="type">const</span> {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> distance &gt; other.distance;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">};</span><br><span class="line"><span class="comment">// è¾¹ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> {</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> from; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// èµ·å§‹é¡¶ç‚¹ç´¢å¼•</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> to; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// ç»ˆæ­¢é¡¶ç‚¹ç´¢å¼•</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> weight; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// è¾¹çš„æƒé‡</span></span><br><span class="line">&nbsp; &nbsp; <span class="built_in">Edge</span>(<span class="type">int</span> f, <span class="type">int</span> t, <span class="type">int</span> w) : <span class="built_in">from</span>(f), <span class="built_in">to</span>(t), <span class="built_in">weight</span>(w) {}</span><br><span class="line">};</span><br><span class="line"><span class="comment">// å›¾ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Graph</span> {</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> V; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="comment">// é¡¶ç‚¹æ•°é‡</span></span><br><span class="line">&nbsp; &nbsp; vector&lt;vector&lt;Edge&gt;&gt; adj; &nbsp; <span class="comment">// é‚»æ¥è¡¨</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">&nbsp; &nbsp; <span class="built_in">Graph</span>(<span class="type">int</span> vertices) : <span class="built_in">V</span>(vertices) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; adj.<span class="built_in">resize</span>(V);</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> weight)</span> </span>{</span><br><span class="line">&nbsp;   &nbsp; &nbsp; adj[from].<span class="built_in">push_back</span>(<span class="built_in">Edge</span>(from, to, weight));</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; vector&lt;vector&lt;Edge&gt;&gt; <span class="built_in">getAdj</span>() {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> adj;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">int</span> <span class="title">getV</span><span class="params">()</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> V;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">};</span><br><span class="line"><span class="comment">// Dijkstra ç®—æ³•</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dijkstra</span> {</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">initializeSingleSource</span><span class="params">(Graph&amp; G, <span class="type">int</span> s, vector&lt;Vertex&gt;&amp; vertices)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> V = G.<span class="built_in">getV</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; vertices.<span class="built_in">clear</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; vertices.<span class="built_in">reserve</span>(V);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; V; ++i) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vertices.<span class="built_in">push_back</span>(<span class="built_in">Vertex</span>(i, numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>(), <span class="number">-1</span>));</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; vertices[s].distance = <span class="number">0</span>;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">relax</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> weight, vector&lt;Vertex&gt;&amp; vertices, priority_queue&lt;Vertex, vector&lt;Vertex&gt;, greater&lt;Vertex&gt;&gt;&amp; Q)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">if</span> (vertices[v].distance &gt; vertices[u].distance + weight) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vertices[v].distance = vertices[u].distance + weight;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vertices[v].parent = u;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// é‡æ–°æ„å»ºä¼˜å…ˆé˜Ÿåˆ—</span></span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; priority_queue&lt;Vertex, vector&lt;Vertex&gt;, greater&lt;Vertex&gt;&gt; updatedQ;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>()) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; updatedQ.<span class="built_in">push</span>(Q.<span class="built_in">top</span>());</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Q.<span class="built_in">pop</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">swap</span>(Q, updatedQ);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">dijkstra</span><span class="params">(Graph&amp; G, <span class="type">int</span> s)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> V = G.<span class="built_in">getV</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; vector&lt;Vertex&gt; vertices;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; priority_queue&lt;Vertex, vector&lt;Vertex&gt;, greater&lt;Vertex&gt;&gt; Q;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">initializeSingleSource</span>(G, s, vertices);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (Vertex v : vertices) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Q.<span class="built_in">push</span>(v);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>()) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Vertex uVertex = Q.<span class="built_in">top</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Q.<span class="built_in">pop</span>();</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> u = uVertex.index;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vector&lt;Edge&gt; neighbors = G.<span class="built_in">getAdj</span>()[u];</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (Edge edge : neighbors) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> v = edge.to;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> weight = edge.weight;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">relax</span>(u, v, weight, vertices, Q);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">printShortestPaths</span>(s, vertices);</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">printShortestPaths</span><span class="params">(<span class="type">int</span> source, <span class="type">const</span> vector&lt;Vertex&gt;&amp; vertices)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; <span class="string">"Shortest Paths from source vertex "</span> &lt;&lt; source &lt;&lt; <span class="string">":"</span> &lt;&lt; endl;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">const</span> Vertex&amp; v : vertices) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; <span class="string">"Vertex "</span> &lt;&lt; v.index &lt;&lt; <span class="string">": Distance = "</span> &lt;&lt; v.distance &lt;&lt; <span class="string">", Parent = "</span> &lt;&lt; v.parent &lt;&lt; endl;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">&nbsp; &nbsp; <span class="comment">// æ„å»ºå›¾</span></span><br><span class="line">&nbsp; &nbsp; <span class="function">Graph <span class="title">G</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> source = <span class="number">0</span>;</span><br><span class="line">&nbsp; &nbsp; Dijkstra::<span class="built_in">dijkstra</span>(G, source);</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Bellman-Ford-ç®—æ³•"><a href="#Bellman-Ford-ç®—æ³•" class="headerlink" title="Bellman-Ford ç®—æ³•"></a>Bellman-Ford ç®—æ³•</h2><p>Bellman-Ford ç®—æ³•è§£å†³çš„æ˜¯ä¸€èˆ¬æƒ…å†µä¸‹å•æºæœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œè¾¹çš„æƒé‡å¯ä»¥ä¸ºè´Ÿå€¼ã€‚Bellman-Ford ç®—æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¯¥å¸ƒå°”å€¼è¡¨æ˜æ˜¯å¦å­˜åœ¨ä¸€ä¸ªä»æºç‚¹å¯è¾¾çš„è´Ÿæƒé‡çš„ç¯è·¯ã€‚è‹¥å­˜åœ¨è¿™æ ·ä¸€ä¸ªç¯è·¯ï¼Œåˆ™ç®—æ³•æç¤ºä¸å­˜åœ¨è§£å†³æ–¹æ¡ˆã€‚è‹¥ä¸å­˜åœ¨è¿™æ ·ä¸€ä¸ªç¯è·¯ï¼Œåˆ™ç®—æ³•ç»™å‡ºæœ€çŸ­è·¯å¾„å’Œå®ƒä»¬çš„æƒé‡ã€‚<br>æ³¨æ„ï¼šè´Ÿæƒé‡ç¯è·¯æ˜¯æ€»æƒé‡ä¸ºè´Ÿçš„ç¯è·¯ï¼Œè€Œéåªè¦æœ‰è´Ÿæƒé‡çš„è¾¹æ‰€å½¢æˆçš„ç¯è·¯å°±æ˜¯è´Ÿæƒé‡ç¯è·¯ã€‚<br>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>$BELLMAN-FORD(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE(G, s)$<br>2 for $i = 1$ to $|G.V| - 1$<br>3 for each edge $(u, v) \in G.E$<br>4 RELAX(u, v, w)<br>5 for each edge $(u, v) \in G.E$<br>6 if $v.d &gt; u.d + w(u, v)$<br>7 return FALSE<br>8 return TRUE</p>
</blockquote>
<p>ç¤ºä¾‹å›¾ï¼š<br><img src="https://telegraph-image-eja.pages.dev/file/4af76847af45d3632f2c2.png" alt="image"><br>// ä»ä¸Šå›¾æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨æ¯ä¸€æ¬¡è¿­ä»£ä¸­éƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„ d å€¼è¢«ç¡®å®šï¼Œä¸å†æ”¹å˜ã€‚ä¾æ¬¡è¢«ç¡®å®šçš„èŠ‚ç‚¹æ˜¯ï¼š$&lt;s,y,x,t,z&gt;$ï¼Œå› ä¸ºè¿™ä¾‹å­æ¯”è¾ƒç‰¹æ®Šï¼Œæ¯æ¬¡è¿­ä»£éƒ½åªç¡®å®šä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œé€šå¸¸å°‘äº $V-1$ æ¬¡è¿­ä»£å°±å¯ä»¥ç¡®å®šå®Œï¼Œå› æ­¤æ­£ç¡®çš„è¡¨è¿°æ˜¯æ¯æ¬¡è¿­ä»£éƒ½è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„ d å€¼è¢«ç¡®å®šã€‚</p>
<h4 id="æ—¶é—´å¤æ‚åº¦åˆ†æ-é‚»æ¥è¡¨"><a href="#æ—¶é—´å¤æ‚åº¦åˆ†æ-é‚»æ¥è¡¨" class="headerlink" title="æ—¶é—´å¤æ‚åº¦åˆ†æ(é‚»æ¥è¡¨)"></a>æ—¶é—´å¤æ‚åº¦åˆ†æ (é‚»æ¥è¡¨)</h4><blockquote>
<p>$BELLMAN-FORD(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE(G, s)$ //$\Theta(V)$<br>2 for $i = 1$ to $|V| - 1$<br>3 for each vertex $u\in V$<br>4 for each vertex $v \in G.Adj[u]$<br>5 RELAX (u, v, w) //2-5: $\Theta (V + E)$ å¾ªç¯ $V-1$ æ¬¡<br>6 for each vertex $u\in V$<br>7 for each vertex $v\in G.Adj[u]$<br>8 if $v.d &gt; u.d + w(u, v)$<br>9 return FALSE //6-9: O(V + E)<br>10 return TRUE</p>
</blockquote>
<p>å› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O (V^2 + VE)$ï¼Œè‹¥ $E=\Omega (V)$ï¼Œåˆ™æ—¶é—´å¤æ‚åº¦å¯ä»¥è¡¨ç¤ºä¸º $O (VE)$ã€‚</p>
<h4 id="ç©ºé—´å¤æ‚åº¦åˆ†æ-1"><a href="#ç©ºé—´å¤æ‚åº¦åˆ†æ-1" class="headerlink" title="ç©ºé—´å¤æ‚åº¦åˆ†æ"></a>ç©ºé—´å¤æ‚åº¦åˆ†æ</h4><blockquote>
<p>$BELLMAN-FORD(G, w, s)$<br>1 $INITIALIZE-SINGLE-SOURCE(G, s)$ //O(V)<br>2 for $i = 1$ to $|V| - 1$<br>3 for each vertex $u\in V$<br>4 for each vertex $v \in G.Adj[u]$<br>5 RELAX(u, v, w)<br>6 for each vertex $u\in V$<br>7 for each vertex $v\in G.Adj[u]$<br>8 if $v.d &gt; u.d + w(u, v)$<br>9 return FALSE<br>10 return TRUE</p>
</blockquote>
<p>å› æ­¤æ€»çš„ç©ºé—´å¤æ‚åº¦ä¸º O (V)</p>
<h4 id="Theorem-Correctness-of-the-Bellman-Ford-algorithm"><a href="#Theorem-Correctness-of-the-Bellman-Ford-algorithm" class="headerlink" title="Theorem(Correctness of the Bellman-Ford algorithm)"></a>Theorem(Correctness of the Bellman-Ford algorithm)</h4><p>å‡è®¾ ğº ä¸­ä¸å­˜åœ¨ä»æºç‚¹ ğ‘  å¯è¾¾çš„è´Ÿæƒé‡çš„ç¯è·¯ï¼Œåœ¨ç®—æ³•è¿è¡Œç»“æŸæ—¶ï¼Œå¯¹äºä»»æ„ä¸€æ¡è¾¹ $(ğ‘¢,ğ‘£)âˆˆğ¸$ï¼Œæœ‰<br>$v.d=\delta(s, v)$<br>$\le \delta(s, u) + w(u, v)$<br>$= u.d + w(u, v)$<br>æ­¤æ—¶ç®—æ³•ä¸€å®šè¿”å› TRUE</p>
<p>å‡è®¾ G ä¸­å­˜åœ¨ä»æºç‚¹ s å¯è¾¾çš„è´Ÿæƒé‡ç¯è·¯ï¼Œè®¾è¯¥ç¯è·¯ä¸º $c=&lt;v_0,v_1,â€¦,v_k&gt;$ï¼Œå…¶ä¸­ $v_0=v_k$ï¼Œæœ‰</p>
<p>$$<br>\sum_{i=1}^{k}w(v_{i-1},v_{i})&lt;0<br>$$</p>
<p>æ¥ä¸‹æ¥ç”¨åè¯æ³•ï¼Œå‡è®¾ç®—æ³•è¿”å› TRUEï¼Œåˆ™å¯¹äº $i=1,2,â€¦,k$ï¼Œæœ‰ $v_i.d \le v_{i-1}.d+w (v_{i-1},v_i)$</p>
<p>$$<br>\sum_{i=1}^k v_i.d \leq\sum_{i=1}^k (v_{i-1}.d + w(v_{i-1}, v_i))<br>$$</p>
<p>$$<br>=\sum_{i=1}^k v_{i-1}.d +\sum_{i=1}^k w(v_{i-1}, v_i)<br>$$</p>
<p>ç”±äº $v_0=v_k$ï¼Œé‚£ä¹ˆ</p>
<p>$$<br>\sum_{i=1}^k v_i.d =\sum_{i=1}^k v_{i-1}.d<br>$$</p>
<p>è§£å¾—</p>
<p>$$<br>0\leq\sum_{i=1}^k w(v_{i-1}, v_i)<br>$$</p>
<p>ä¸ä¸Šé¢çš„ä¸ç­‰å¼çŸ›ç›¾ï¼Œå› æ­¤ç®—æ³•è¿”å›çš„æ˜¯ FALSEï¼Œæ‰€ä»¥ bellman-ford ç®—æ³•èƒ½æ£€æŸ¥è´Ÿæƒé‡ç¯è·¯ï¼Œå› æ­¤èƒ½å¤„ç†è´Ÿè¾¹ã€‚</p>
<h4 id="cpp-ç®—æ³•å®ç°-1"><a href="#cpp-ç®—æ³•å®ç°-1" class="headerlink" title="cpp ç®—æ³•å®ç°"></a>cpp ç®—æ³•å®ç°</h4><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;limits&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// è¾¹ç»“æ„ä½“</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span> {</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> to; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// ç»ˆæ­¢é¡¶ç‚¹ç´¢å¼•</span></span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> weight; &nbsp; &nbsp; &nbsp; &nbsp; <span class="comment">// è¾¹çš„æƒé‡</span></span><br><span class="line">&nbsp; &nbsp; <span class="built_in">Edge</span>(<span class="type">int</span> t, <span class="type">int</span> w) : <span class="built_in">to</span>(t), <span class="built_in">weight</span>(w) {}</span><br><span class="line">};</span><br><span class="line"><span class="comment">// å›¾ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Graph</span> {</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> V; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<span class="comment">// é¡¶ç‚¹æ•°é‡</span></span><br><span class="line">&nbsp; &nbsp; vector&lt;vector&lt;Edge&gt;&gt; adj; &nbsp; <span class="comment">// é‚»æ¥è¡¨</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">&nbsp; &nbsp; <span class="built_in">Graph</span>(<span class="type">int</span> vertices) : <span class="built_in">V</span>(vertices) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; adj.<span class="built_in">resize</span>(V);</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line"></span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">void</span> <span class="title">addEdge</span><span class="params">(<span class="type">int</span> from, <span class="type">int</span> to, <span class="type">int</span> weight)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; adj[from].<span class="built_in">push_back</span>(<span class="built_in">Edge</span>(to, weight));</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line"></span><br><span class="line">&nbsp; &nbsp; vector&lt;vector&lt;Edge&gt;&gt;&amp; <span class="built_in">getAdj</span>() {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> adj;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line"></span><br><span class="line">&nbsp; &nbsp; <span class="function"><span class="type">int</span> <span class="title">getV</span><span class="params">()</span> </span>{</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> V;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">};</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å•æºæœ€çŸ­è·¯å¾„</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">initializeSingleSource</span><span class="params">(Graph&amp; G, <span class="type">int</span> s, vector&lt;<span class="type">int</span>&gt;&amp; distance, vector&lt;<span class="type">int</span>&gt;&amp; predecessor)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> V = G.<span class="built_in">getV</span>();</span><br><span class="line">&nbsp; &nbsp; distance.<span class="built_in">clear</span>();</span><br><span class="line">&nbsp; &nbsp; distance.<span class="built_in">resize</span>(V, numeric_limits&lt;<span class="type">int</span>&gt;::<span class="built_in">max</span>());</span><br><span class="line">&nbsp; &nbsp; predecessor.<span class="built_in">clear</span>();</span><br><span class="line">&nbsp; &nbsp; predecessor.<span class="built_in">resize</span>(V, <span class="number">-1</span>);</span><br><span class="line">&nbsp; &nbsp; distance[s] = <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// æ¾å¼›æ“ä½œ</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">relax</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> weight, vector&lt;<span class="type">int</span>&gt;&amp; distance, vector&lt;<span class="type">int</span>&gt;&amp; predecessor)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">if</span> (distance[v] &gt; distance[u] + weight) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; distance[v] = distance[u] + weight;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; predecessor[v] = u;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">}</span><br><span class="line"><span class="comment">// Bellman-Ford ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bellmanFord</span><span class="params">(Graph&amp; G, <span class="type">int</span> s, vector&lt;<span class="type">int</span>&gt;&amp; distance, vector&lt;<span class="type">int</span>&gt;&amp; predecessor)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> V = G.<span class="built_in">getV</span>();</span><br><span class="line">&nbsp; &nbsp; <span class="built_in">initializeSingleSource</span>(G, s, distance, predecessor);</span><br><span class="line">&nbsp; &nbsp; <span class="comment">// é‡å¤ |V| - 1 æ¬¡æ¾å¼›æ“ä½œ</span></span><br><span class="line">&nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= V - <span class="number">1</span>; ++i) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">0</span>; u &lt; V; ++u) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (Edge edge : G.<span class="built_in">getAdj</span>()[u]) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> v = edge.to;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> weight = edge.weight;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">relax</span>(u, v, weight, distance, predecessor);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="comment">// æ£€æŸ¥æ˜¯å¦å­˜åœ¨è´Ÿæƒå›è·¯</span></span><br><span class="line">&nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">int</span> u = <span class="number">0</span>; u &lt; V; ++u) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (Edge edge : G.<span class="built_in">getAdj</span>()[u]) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> v = edge.to;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="type">int</span> weight = edge.weight;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">if</span> (distance[v] &gt; distance[u] + weight) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// å­˜åœ¨è´Ÿæƒå›è·¯</span></span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// ä¸å­˜åœ¨è´Ÿæƒå›è·¯</span></span><br><span class="line">}</span><br><span class="line"><span class="comment">// è¾“å‡ºæœ€çŸ­è·¯å¾„</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printShortestPath</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> v, <span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; predecessor)</span> </span>{</span><br><span class="line">&nbsp; &nbsp; stack&lt;<span class="type">int</span>&gt; path;</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> current = v;</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">while</span> (current != s) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; path.<span class="built_in">push</span>(current);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; current = predecessor[current];</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; path.<span class="built_in">push</span>(s);</span><br><span class="line">&nbsp; &nbsp; cout &lt;&lt; <span class="string">"Shortest path from "</span> &lt;&lt; s &lt;&lt; <span class="string">" to "</span> &lt;&lt; v &lt;&lt; <span class="string">": "</span>;</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">while</span> (!path.<span class="built_in">empty</span>()) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; path.<span class="built_in">top</span>() &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; path.<span class="built_in">pop</span>();</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; cout &lt;&lt; endl;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>{</span><br><span class="line">&nbsp; &nbsp; <span class="comment">// æ„å»ºå›¾</span></span><br><span class="line">&nbsp; &nbsp; <span class="function">Graph <span class="title">G</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">0</span>, <span class="number">1</span>, <span class="number">6</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">0</span>, <span class="number">2</span>, <span class="number">7</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">-4</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">2</span>, <span class="number">4</span>, <span class="number">-3</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="number">7</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">4</span>, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">&nbsp; &nbsp; G.<span class="built_in">addEdge</span>(<span class="number">4</span>, <span class="number">3</span>, <span class="number">7</span>);</span><br><span class="line">&nbsp; &nbsp; <span class="type">int</span> source = <span class="number">0</span>;</span><br><span class="line">&nbsp; &nbsp; vector&lt;<span class="type">int</span>&gt; distance;</span><br><span class="line">&nbsp; &nbsp; vector&lt;<span class="type">int</span>&gt; predecessor;</span><br><span class="line">&nbsp; &nbsp; <span class="keyword">if</span> (<span class="built_in">bellmanFord</span>(G, source, distance, predecessor)) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; <span class="string">"No negative weight cycle detected."</span> &lt;&lt; endl;</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">for</span> (<span class="type">int</span> v = <span class="number">0</span>; v &lt; G.<span class="built_in">getV</span>(); ++v) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="keyword">if</span> (v != source) {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="built_in">printShortestPath</span>(source, v, predecessor);</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; }</span><br><span class="line">&nbsp; &nbsp; } <span class="keyword">else</span> {</span><br><span class="line">&nbsp; &nbsp; &nbsp; &nbsp; cout &lt;&lt; <span class="string">"Negative weight cycle detected."</span> &lt;&lt; endl;</span><br><span class="line">&nbsp; &nbsp; }</span><br><span class="line"> &nbsp; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://ius7.qzz.io">Szj</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://ius7.qzz.io/2024/05/12/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/">https://ius7.qzz.io/2024/05/12/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://ius7.qzz.io" target="_blank">ius</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">ç®—æ³•</a><a class="post-meta__tags" href="/tags/%E5%9B%BE%E8%AE%BA/">å›¾è®º</a><a class="post-meta__tags" href="/tags/%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84/">æœ€çŸ­è·¯å¾„</a><a class="post-meta__tags" href="/tags/Dijkstra/">Dijkstra</a><a class="post-meta__tags" href="/tags/Bellman-Ford/">Bellman-Ford</a></div><div class="post-share"><div class="social-share" data-image="/img/banners/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>èµåŠ©</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/wechat.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2024/04/25/Minimum%20Spanning%20Trees/" title="Minimum Spanning Trees"><img class="cover" src="/img/banners/Minimum%20Spanning%20Trees.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">Minimum Spanning Trees</div></div></div></a><a class="pagination-related  no-desc" href="/2024/05/27/hamming-numbers-%E6%B1%89%E6%98%8E%E6%95%B0/" title="æ±‰æ˜æ•° (Hamming Numbers)"><img class="cover" src="/img/banners/hamming-numbers-%E6%B1%89%E6%98%8E%E6%95%B0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">æ±‰æ˜æ•° (Hamming Numbers)</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related no-desc" href="/2024/04/21/Elementary-Graph-Algorithms/" title="Elementary Graph Algorithms"><img class="cover" src="/img/banners/Elementary-Graph-Algorithms.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-21</div><div class="info-item-2">Elementary Graph Algorithms</div></div></div></a><a class="pagination-related no-desc" href="/2024/05/30/%E6%9C%80%E5%A4%A7%E6%B5%81/" title="æœ€å¤§æµ (Maximum Flow)"><img class="cover" src="/img/banners/%E6%9C%80%E5%A4%A7%E6%B5%81.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-30</div><div class="info-item-2">æœ€å¤§æµ (Maximum Flow)</div></div></div></a><a class="pagination-related no-desc" href="/2024/06/11/Kmp%E7%AE%97%E6%B3%95/" title="KMP å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•"><img class="cover" src="/img/banners/Kmp%E7%AE%97%E6%B3%95.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-11</div><div class="info-item-2">KMP å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•</div></div></div></a><a class="pagination-related no-desc" href="/2024/04/25/Minimum%20Spanning%20Trees/" title="Minimum Spanning Trees"><img class="cover" src="/img/banners/Minimum%20Spanning%20Trees.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-25</div><div class="info-item-2">Minimum Spanning Trees</div></div></div></a><a class="pagination-related no-desc" href="/2024/03/31/dynamic%20programming/" title="åŠ¨æ€è§„åˆ’ (Dynamic Programming)"><img class="cover" src="/img/banners/dynamic%20programming.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-31</div><div class="info-item-2">åŠ¨æ€è§„åˆ’ (Dynamic Programming)</div></div></div></a><a class="pagination-related no-desc" href="/2024/07/07/fusc-%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/" title="fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–"><img class="cover" src="/img/banners/fusc-%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-07-07</div><div class="info-item-2">fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/vinyltocat.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Szj</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">44</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Szj510"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Szj510" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:suzijie510@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content"></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84-SSSP"><span class="toc-number">1.</span> <span class="toc-text">å•æºæœ€çŸ­è·¯å¾„ (SSSP)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">å†™åœ¨å‰é¢</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%9A%84%E8%BE%93%E5%85%A5"><span class="toc-number">1.1.1.</span> <span class="toc-text">å›¾çš„è¾“å…¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%BE%E5%BC%9B-Relaxation"><span class="toc-number">1.1.2.</span> <span class="toc-text">æ¾å¼› (Relaxation)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E8%B7%AF%E5%BE%84%E6%80%A7%E8%B4%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">æ— è·¯å¾„æ€§è´¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E7%95%8C%E6%80%A7%E8%B4%A8"><span class="toc-number">1.1.4.</span> <span class="toc-text">ä¸Šç•Œæ€§è´¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B6%E6%95%9B%E6%80%A7%E8%B4%A8"><span class="toc-number">1.1.5.</span> <span class="toc-text">æ”¶æ•›æ€§è´¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dijkstra-%E7%AE%97%E6%B3%95"><span class="toc-number">1.2.</span> <span class="toc-text">Dijkstra ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Theorem-Correctness-of-Dijkstra%E2%80%99s-algorithm"><span class="toc-number">1.2.1.</span> <span class="toc-text">Theorem(Correctness of Dijkstraâ€™s algorithm)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">æ—¶é—´å¤æ‚åº¦åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90"><span class="toc-number">1.2.3.</span> <span class="toc-text">ç©ºé—´å¤æ‚åº¦åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cpp-%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.2.4.</span> <span class="toc-text">cpp ç®—æ³•å®ç°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bellman-Ford-%E7%AE%97%E6%B3%95"><span class="toc-number">1.3.</span> <span class="toc-text">Bellman-Ford ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90-%E9%82%BB%E6%8E%A5%E8%A1%A8"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">æ—¶é—´å¤æ‚åº¦åˆ†æ (é‚»æ¥è¡¨)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6%E5%88%86%E6%9E%90-1"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">ç©ºé—´å¤æ‚åº¦åˆ†æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Theorem-Correctness-of-the-Bellman-Ford-algorithm"><span class="toc-number">1.3.0.3.</span> <span class="toc-text">Theorem(Correctness of the Bellman-Ford algorithm)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cpp-%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0-1"><span class="toc-number">1.3.0.4.</span> <span class="toc-text">cpp ç®—æ³•å®ç°</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/10/30/Auto-Generate-Banners/" title="ä½¿ç”¨ Unsplash è‡ªåŠ¨ç”Ÿæˆæ–‡ç« é¢˜å¤´å›¾ï¼ˆå®è·µä¸å®ç°ï¼‰"><img src="/img/banners/Auto-Generate-Banners.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ä½¿ç”¨ Unsplash è‡ªåŠ¨ç”Ÿæˆæ–‡ç« é¢˜å¤´å›¾ï¼ˆå®è·µä¸å®ç°ï¼‰"/></a><div class="content"><a class="title" href="/2025/10/30/Auto-Generate-Banners/" title="ä½¿ç”¨ Unsplash è‡ªåŠ¨ç”Ÿæˆæ–‡ç« é¢˜å¤´å›¾ï¼ˆå®è·µä¸å®ç°ï¼‰">ä½¿ç”¨ Unsplash è‡ªåŠ¨ç”Ÿæˆæ–‡ç« é¢˜å¤´å›¾ï¼ˆå®è·µä¸å®ç°ï¼‰</a><time datetime="2025-10-30T04:30:00.000Z" title="å‘è¡¨äº 2025-10-30 12:30:00">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/06/Git-Command/" title="Git Command è‡ªç”¨"><img src="/img/banners/Git-Command.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git Command è‡ªç”¨"/></a><div class="content"><a class="title" href="/2025/08/06/Git-Command/" title="Git Command è‡ªç”¨">Git Command è‡ªç”¨</a><time datetime="2025-08-06T06:40:08.000Z" title="å‘è¡¨äº 2025-08-06 14:40:08">2025-08-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/28/Cpp-Smart-Pointer/" title="Cpp æ™ºèƒ½æŒ‡é’ˆ"><img src="/img/banners/Cpp-Smart-Pointer.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cpp æ™ºèƒ½æŒ‡é’ˆ"/></a><div class="content"><a class="title" href="/2024/09/28/Cpp-Smart-Pointer/" title="Cpp æ™ºèƒ½æŒ‡é’ˆ">Cpp æ™ºèƒ½æŒ‡é’ˆ</a><time datetime="2024-09-28T02:00:00.000Z" title="å‘è¡¨äº 2024-09-28 10:00:00">2024-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/25/Rust%20%E5%85%A5%E5%9D%91%E7%AF%87/" title="Rust å…¥å‘ç¯‡"><img src="/img/banners/Rust%20%E5%85%A5%E5%9D%91%E7%AF%87.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Rust å…¥å‘ç¯‡"/></a><div class="content"><a class="title" href="/2024/09/25/Rust%20%E5%85%A5%E5%9D%91%E7%AF%87/" title="Rust å…¥å‘ç¯‡">Rust å…¥å‘ç¯‡</a><time datetime="2024-09-25T15:29:00.000Z" title="å‘è¡¨äº 2024-09-25 23:29:00">2024-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/07/fusc-%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/" title="fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–"><img src="/img/banners/fusc-%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–"/></a><div class="content"><a class="title" href="/2024/07/07/fusc-%E5%B0%BE%E9%80%92%E5%BD%92%E4%BC%98%E5%8C%96/" title="fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–">fusc å‡½æ•°ä¸å°¾é€’å½’ä¼˜åŒ–</a><time datetime="2024-07-07T02:00:00.000Z" title="å‘è¡¨äº 2024-07-07 10:00:00">2024-07-07</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2024 - 2025 By Szj</span></div><div class="footer_custom_text"><p><a target="_blank" href="https://hexo.io/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="åšå®¢æ¡†æ¶ä¸ºHexo"></a>&nbsp;<img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="ä¸»é¢˜é‡‡ç”¨butterfly"></a>&nbsp;<a target="_blank" href="https://github.com/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="æœ¬ç«™é¡¹ç›®ç”±Gtihubæ‰˜ç®¡"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="æœ¬ç«™é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº«4.0å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.4.3"></script><script src="/js/main.js?v=5.4.3"></script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: true,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }

      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":false,"id":"location.pathname"}

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: '95998e7ed95c5dfc6d4a',
      clientSecret: '975e1be8ac3c393708c3e62cea2a49c33bd13882',
      repo: 'ius-blog',
      owner: 'Szj510',
      admin: ['Szj510'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || 'fcd9fd365949a70d1402dcbb03d15b78'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><link rel="stylesheet" href="/css/music-override.css"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><!-- æ·»åŠ éŸ³ä¹é¡µé¢çš„JavaScriptæ”¯æŒ--><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script async data-pjax src="https://npm.elemecdn.com/hexo-anzhiyu-music@1.0.2/assets/js/music.js"></script><!-- hexo injector body_end end --></body></html>